Hello! This is some friendly information from the last person working on this PWA

Links:
[Good News](#the-good-news)
[Bad News](#the-bad-news)
[My Attempts at Fixing the Caching](#heres-some-ways-i-tried-getting-the-service-worker-to-cache-url-files)
[Helpful Tips](#some-things-that-might-help)

### The good news:
1. ##### There are custom installation prompts for each major OS (iOS, Android, Windows, Mac)
2. ##### The PWA installs and works correctly
3. ##### There is a custom offline page

### The bad news:
1. ##### Caching of url files (js, html, and css from the vue files) doesn't work
    1. As such, the app doesn't work at all offline; it just shows the offline page
    2. We want to be able to cache these files and have them served by this service worker so that the app can be used offline, with most of the functionality intact

#### Some ways I tried getting the service worker to cache url files:
1. ##### Moving the scope of the service worker by moving it to the 'src' (and higher) directory
    1. This didn't work because the scope isn't the issue. The service worker's scope can already see all data traffic on the website, no matter its 'physical' location

2. ##### Adding code to custom-service-worker.ts to cache every static (includes js, css, html) file in navigation requests
    1. I actually don't know why this didn't work, so it might be worth a try. It was never automatically added to the sw.js file generated by Quasar, and it can't be manually added to sw.js because each time the project is started it rewrites sw.js
    2. 
    ```javascript
        // Cache page navigations with a Network First strategy
        registerRoute(
        // Check to see if the request is a navigation to a new page
        ({ request }) => request.mode === 'navigate',
        new NetworkFirst({
            cacheName: 'pages',
            plugins: [
            new workbox.cacheableResponse.Plugin({
                statuses: [200],
            }),
            ],
        }),
        );
    ```    
3. ##### Adding an extra cache in the service worker's runtimeCaching Workbox Option to cache all js, css, and html files the service worker saw
    1. In **quasar.config.js**, in **build/pwa/workboxOptions/runtimeCaching** (around line 50)
        1. 
        ```javascript
        {
            urlPattern: /\.(?:js|css|html)$/,
            handler: 'StaleWhileRevalidate',
            options: {
            cacheName: 'static-assets-cache',
            expiration: {
                maxEntries: 200,
                maxAgeSeconds: 60 * 60 * 24 * 30, // 30 days
            },
            },
        }
        ```
    2. Don't know why this doesn't work either. The cache wasn't created, but there were no errors 
        1. The vue files for the pages are sent to the browser as js/css/html files, so that's what the service worker would see

4. ##### Attempting to 'precacheAndRoute' all url patterns/their files in the app, similarly to how the icons are correctly cached at the bottom 30 lines of sw.js
    1. Caching the files didn't work because the js, css, and html files made from the vue files are generated with a different name each time they're sent (with a random number at the end). Because of this, we can't simply cache what the generated files will always be named, since it changes. We also can't cache the vue files, because neither the browser nor service worker know how to handle them
    2. Not sure why caching the url patterns didn't work. I think it's similar to why caching the files didn't work, but might also be because there's no way for it to keep track of the revision of the file if it's a url pattern that uses (potentially) multiple files
    3. In **custom-service-worker.ts**
    ```javascript
    // Adding urls to precache
    const WorkboxWebpackPlugin = require('workbox-webpack-plugin');

    module.exports = {
    // other webpack config...
    plugins: [
        new WorkboxWebpackPlugin.InjectManifest({
        swSrc: './src/custom-service-worker.js',
        swDest: 'service-worker.js',
        additionalManifestEntries: [
            {url: '/home', revision: null},
            {url: '/app', revision: null},
            {url: '/chat', revision: null},
            // add more URLs as needed, revisions are auto-generated
        ],
        }),
    ],
    };
    ```

#### Some things that might help:


1. ##### Learn how Quasar auto-generates the sw.js file
    1. This will help you learn how to update the **sw.js** file with the code you want

2. ##### Learn the service worker lifecycle
    1. This will help you learn the best times to cache files and fetch them
        1. The 'Install' event is usually the best time to cache all common files that everyone uses
        2. 'Fetch' events attempt to get necessary files from the cache (if they exist there)
3. ##### Good sources to check out
    1. [Quasar PWA Guide](https://quasar.dev/quasar-cli-vite/developing-pwa/introduction)
    2. [Explore PWA's (web.dev)](https://web.dev/explore/progressive-web-apps)
